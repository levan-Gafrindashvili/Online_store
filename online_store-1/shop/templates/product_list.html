{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Online Shop</title>
  <link rel="stylesheet" href="{% static 'css/style.css' %}" />
</head>
<body>
  <h1>Online Shop</h1>

  <!-- Top Bar with Search and Login/Logout -->
  <div class="top-bar" style="display: flex; justify-content: space-between; align-items: center;">
    <!-- Search -->
    <form method="get" style="display: flex; gap: 10px; flex: 1;">
      <input
        type="text"
        name="q"
        placeholder="Search products..."
        value="{{ request.GET.q|default:'' }}"
        style="flex: 1;"
        aria-label="Search products"
      />
      <button type="submit">Search</button>
      {% if request.GET %}
        <a href="{% url 'product_list' %}" style="align-self: center; margin-left: 10px;">Reset Filters</a>
      {% endif %}
    </form>

    <!-- Login/Logout -->
    <div style="margin-left: 20px;">
      {% if user.is_authenticated %}
        <span>Welcome, {{ user.username }} | </span>
        <a href="{% url 'logout' %}" class="btn">Logout</a>
      {% else %}
        <a href="{% url 'login' %}" class="btn">Login</a>
      {% endif %}
    </div>
  </div>

  <div class="container" style="display: flex; gap: 20px; margin-top: 20px;">
    <!-- Filters -->
    <aside style="flex: 0 0 250px;">
      <form method="get">
        <input type="hidden" name="q" value="{{ request.GET.q|default:'' }}" />

        <h3>Category</h3>
        <select name="category">
          <option value="">All</option>
          {% for cat in categories %}
          <option value="{{ cat.id }}" {% if cat.id|stringformat:"s" == request.GET.category %}selected{% endif %}>{{ cat.name }}</option>
          {% endfor %}
        </select>

        <h3>Subcategory</h3>
        <select name="subcategory">
          <option value="">All</option>
          {% for sub in subcategories %}
          <option value="{{ sub.id }}" {% if sub.id|stringformat:"s" == request.GET.subcategory %}selected{% endif %}>{{ sub.name }}</option>
          {% endfor %}
        </select>

        <h3>Brand</h3>
        <select name="brand">
          <option value="">All</option>
          {% for b in brands %}
          <option value="{{ b.id }}" {% if b.id|stringformat:"s" == request.GET.brand %}selected{% endif %}>{{ b.name }}</option>
          {% endfor %}
        </select>

        <h3>Price</h3>
        <input
          type="number"
          name="min_price"
          placeholder="Min"
          step="0.01"
          value="{{ request.GET.min_price|default:'' }}"
          aria-label="Minimum price"
        />
        <input
          type="number"
          name="max_price"
          placeholder="Max"
          step="0.01"
          value="{{ request.GET.max_price|default:'' }}"
          aria-label="Maximum price"
        />

        <h3>Rating</h3>
        <input
          type="number"
